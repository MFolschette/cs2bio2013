\subsection{Weak Bisimulation of Asynchronous Discrete Networks}
\label{sec:dn}

We exhibit in this section an encoding of Asynchronous Discrete Networks (ADN),
also called Logical Networks or equivalently Ren√© Thomas Models \cite{Thomas95,deJong02},
into AANs and prove a weak bisimulation relation.
This translation is important as it allows to efficiently study the dynamics of ADNs
by using the static analysis developed in \pref{sec:sa};
indeed, the bisimulation relation ensures that the dynamics of the
resulting AAN model are accurately the same than the original.

A \emph{Discrete Network} gathers a finite number of components $i\in\segm{1}{n}$ having a discrete finite domain
$\mathbb F^i$ that we note $\mathbb{F}^i = \segm{1}{l_i}$.
For each component $i\in\segm{1}{n}$, a map $\mathbb F \rightarrow \mathbb F^i$ is defined, where
$\mathbb F = \mathbb F^1 \times \cdots \times \mathbb F^n$, giving the next value of the component
with respect to the global state of the network.
Typically $f^i$ depends on a subset of components that we denote $\DNdep(f^i)$.
In the case of \emph{Asynchronous Discrete Networks} (ADN), a transition relation $\DNtrans\subseteq \mathbb
F\times \mathbb F$ is defined such that $x\DNtrans x'$ if and only if there exists a unique
$i\in\segm{1}{n}$ such that $\get{x'}{i}=f^i(x)$ and $\forall j\in\segm{1}{n}, j\neq i, \get{x'}{j}
=\get{x}{j}$, \ie one and only one component has been updated.
This is formalised in \pref{def:DN}.

\begin{definition}[Asynchronous Discrete Network]
\label{def:DN}
  An \emph{Asynchronous Discrete Networks} (ADN) is defined by a couple $(\mathbb F, \langle f^1, \dots, f^n \rangle)$
  where $\mathbb{F} = \mathbb{F}^1\times\dots\times\mathbb{F}^n$,
  and $\forall i\in\segm{1}{n}$,
  $f^i: \mathbb{F} \rightarrow \mathbb{F}^i$ with
  $\mathbb{F}^i = \segm{1}{l_i}$ and $l_i \in \sNN$.
  Given two states $x,x'\in\mathbb F$, the transition relation $\DNtrans$ is given by
  \[
  x\DNtrans x' \Longleftrightarrow
    \exists i\in\segm{1}{n}, f^i(x)=\get{x'}{i}
    \wedge \forall j\in\segm{1}{n}, j\neq i, \get{x}{j}=\get{x'}{j}
  \enspace,
  \]
  where $\get{x}{i}$ is the $i$\textsuperscript{th} component of $x$.
  %
  We note $\DNdep(f^i)\subseteq \segm{1}{n}$ the set of components on which the value of $f^i$
  depends: $\forall x,x'\in \mathbb F$ such that $\forall
  j\in\DNdep(f^i), \get{x}{j}=\get{x'}{j}$, necessarily $f^i(x)=f^i(x')$.
\end{definition}

Let us denote the encoding of a given ADN $\DNdef$ into an AAN by $\toPH\DNdef$ (\pref{def:DN2PH}).
For each component $i\in\segm{1}{n}$ of the ADN,
one automaton $a^i$ is built, acting for the component value.
Obviously, $a^i$ has one local state $a^i_k$ per element $k \in \mathbb F^i$.
It is then sufficient to build actions towards $a^i$
depending on any possible state of the components in $\DNdep(f^i)$
and the related value of the evolution function $f^i$.

\begin{definition}[Encoding ($\toPH$)]
\label{def:DN2PH}
  $\toPH\DNdef=(\Sigma,\PHl,\Hits)$ is the AAN encoding the ADN $\DNdef$, with:
  \begin{itemize}
    \item $\Sigma = \{ a^1, \dots, a^n \}$;
    
    \item $\PHl=\underset{i\in\segm{1}{n}}{\times} \PHl_{a^i}$, where
      $\PHl_{a^i}=\{a^i_0, \dots, a^i_{l_i}\}$;
    
    \item $\PHh = \{ \PHfrappe{A}{a^i_j}{a^i_k} \mid
      \exists \varsigma \PHsubl[\PHl]_{\DNdep(f^i)}, \exists x \in \mathbb{F},
      \varsigma \subseteq \encode{x} \wedge
      f^i(x) = k \wedge \PHget{x}{i} = j \wedge j \neq k \wedge
      A = \toset{\varsigma} \}$ where $\encode{x}$ is defined below.
  \end{itemize}
  Given a state $s \in \PHl$ of the AAN,
  $\decode s=x$ is the corresponding state in the ADN:
  $\forall i\in\segm{1}{n}, \get{s}{a^i}=a^i_k \Rightarrow \get{x}{i}=k$.
  Conversely, given a state $x\in \mathbb F$ of the ADN, 
  $\encode x=s$ is the corresponding state in the AAN:
  $\forall i\in\segm{1}{n}, \get{x}{i}=k \Rightarrow \get{s}{a^i}=a^i_k$.
\end{definition}

Finally,
\pref{th:bisimDN} states the weak bisimulation relation between an ADN and its encoding in AAN.
Intuitively, the actions follow strictly the possible transitions of the ADN.
A detailed proof is given in \pref{suppl:proofbisimADN}. \todo{Utile ?}

\begin{theorem}[$\DNdef \approx \toPH\DNdef$]
\label{th:bisimDN}
  If $\DNdef$ is an ADN
  and $\PH = \toPH\DNdef = (\PHs; \PHl; \PHa)$ is its AAN encoding, then:
  \begin{enumerate}
    \item \label{adn2ph} $\forall x,x'\in\mathbb F$,
      $x\DNtrans x' \Longrightarrow \encode x \PHPtrans \encode{x'}$,
    \item \label{ph2adn} $\forall s,s'\in \PHl$,
      $s\PHPtrans s' \Longrightarrow \decode s \DNtrans
      \decode{s'}\enspace.$
  \end{enumerate}
\end{theorem}
